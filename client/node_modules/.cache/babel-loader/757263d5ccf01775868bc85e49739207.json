{"ast":null,"code":"var _jsxFileName = \"/Users/ksena/\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435/React/lessons/Shop_1001/client/src/pages/createBook/CreateBook.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useContext, useState } from 'react';\nimport { useHttp } from '../../hooks/http.hook';\nimport { AuthContext } from '../../context/AuthContext';\nimport { useToggle } from '../../hooks/toggle.hook';\nimport { BookForm } from '../../component/bookForm/BookForm';\nimport { addFieldToBook } from '../../utils/addFieldToBook';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const CreateBook = () => {\n  _s();\n\n  const [form, setForm] = useState({});\n  const [messageCreated, setMessageCreated] = useState('');\n  const {\n    isOpen: isShowSnackbar,\n    onToggle: toggleShowSnackbar\n  } = useToggle();\n  const {\n    userAuth\n  } = useContext(AuthContext);\n  const {\n    loading,\n    request,\n    errorsValid\n  } = useHttp();\n  const setFormBook = useCallback(target => setForm(prevForm => addFieldToBook(prevForm, target)), []);\n  const handlerCreateBook = useCallback(async () => {\n    const formData = new FormData();\n    const newForm = { ...form,\n      sellerId: userAuth.userId\n    };\n    Object.keys(newForm).forEach(formKey => formData.append(formKey, newForm[formKey]));\n    const data = await request({\n      url: 'create/create-book',\n      method: 'POST',\n      body: formData,\n      notJsonContent: true\n    });\n\n    if (data.status === 200) {\n      setForm({});\n      setMessageCreated(data.message);\n      toggleShowSnackbar();\n    }\n  }, [form, request, toggleShowSnackbar, userAuth.userId]);\n  const onCloseSnackbar = useCallback(() => toggleShowSnackbar(), [toggleShowSnackbar]);\n  return /*#__PURE__*/_jsxDEV(BookForm, {\n    namePage: \"New Book\",\n    form: form,\n    setFormBook: setFormBook,\n    loading: loading,\n    errorsValid: errorsValid,\n    messageCreated: messageCreated,\n    isShowSnackbar: isShowSnackbar,\n    onCloseSnackbar: onCloseSnackbar,\n    handlerCreateBook: handlerCreateBook,\n    buttonCreateName: \"Create\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CreateBook, \"Qi9c0QehxfAEEqStxy3v9u5e3Dw=\", false, function () {\n  return [useToggle, useHttp];\n});\n\n_c = CreateBook;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateBook\");","map":{"version":3,"names":["React","useCallback","useContext","useState","useHttp","AuthContext","useToggle","BookForm","addFieldToBook","CreateBook","form","setForm","messageCreated","setMessageCreated","isOpen","isShowSnackbar","onToggle","toggleShowSnackbar","userAuth","loading","request","errorsValid","setFormBook","target","prevForm","handlerCreateBook","formData","FormData","newForm","sellerId","userId","Object","keys","forEach","formKey","append","data","url","method","body","notJsonContent","status","message","onCloseSnackbar"],"sources":["/Users/ksena/Программирование/React/lessons/Shop_1001/client/src/pages/createBook/CreateBook.tsx"],"sourcesContent":["import React, { ChangeEvent, useCallback, useContext, useState } from 'react'\n\nimport { useHttp } from '../../hooks/http.hook'\nimport { AuthContext } from '../../context/AuthContext';\nimport { IBook } from '../../interface/IBook';\nimport { useToggle } from '../../hooks/toggle.hook';\nimport { BookForm } from '../../component/bookForm/BookForm';\nimport { addFieldToBook } from '../../utils/addFieldToBook';\n\nexport const CreateBook = () => {\n    const [form, setForm] = useState<Record<string, keyof Omit<IBook, 'idBook'>>>({})\n    const [messageCreated, setMessageCreated] = useState<string>('')\n    \n    const { isOpen: isShowSnackbar, onToggle: toggleShowSnackbar } = useToggle()\n\n    const { userAuth } = useContext(AuthContext)\n    \n    const { loading, request, errorsValid } = useHttp()\n    \n    const setFormBook = useCallback((target: ChangeEvent<HTMLInputElement>) => \n        setForm(prevForm => addFieldToBook(prevForm, target))\n    , [])\n\n    const handlerCreateBook = useCallback(async() => {\n        const formData = new FormData()\n        const newForm = { ...form, sellerId: userAuth.userId } as Record<string, keyof Omit<IBook, 'idBook'>>\n\n        Object.keys(newForm).forEach((formKey) => formData.append(formKey, newForm[formKey]))\n\n        const data = await request({ url: 'create/create-book', method: 'POST', body: formData, notJsonContent: true })\n\n        if (data.status === 200) {\n            setForm({})\n            setMessageCreated(data.message)\n            toggleShowSnackbar()\n        }\n    }, [form, request, toggleShowSnackbar, userAuth.userId])\n    \n    const onCloseSnackbar = useCallback(() => \n        toggleShowSnackbar()\n    , [toggleShowSnackbar])\n\n    return (\n        <BookForm \n            namePage='New Book'\n            form={form}\n            setFormBook={setFormBook}\n            loading={loading}\n            errorsValid={errorsValid}\n            messageCreated={messageCreated}\n            isShowSnackbar={isShowSnackbar}\n            onCloseSnackbar={onCloseSnackbar}\n            handlerCreateBook={handlerCreateBook}\n            buttonCreateName='Create'\n        />\n    )\n} \n"],"mappings":";;;AAAA,OAAOA,KAAP,IAA6BC,WAA7B,EAA0CC,UAA1C,EAAsDC,QAAtD,QAAsE,OAAtE;AAEA,SAASC,OAAT,QAAwB,uBAAxB;AACA,SAASC,WAAT,QAA4B,2BAA5B;AAEA,SAASC,SAAT,QAA0B,yBAA1B;AACA,SAASC,QAAT,QAAyB,mCAAzB;AACA,SAASC,cAAT,QAA+B,4BAA/B;;AAEA,OAAO,MAAMC,UAAU,GAAG,MAAM;EAAA;;EAC5B,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBR,QAAQ,CAA8C,EAA9C,CAAhC;EACA,MAAM,CAACS,cAAD,EAAiBC,iBAAjB,IAAsCV,QAAQ,CAAS,EAAT,CAApD;EAEA,MAAM;IAAEW,MAAM,EAAEC,cAAV;IAA0BC,QAAQ,EAAEC;EAApC,IAA2DX,SAAS,EAA1E;EAEA,MAAM;IAAEY;EAAF,IAAehB,UAAU,CAACG,WAAD,CAA/B;EAEA,MAAM;IAAEc,OAAF;IAAWC,OAAX;IAAoBC;EAApB,IAAoCjB,OAAO,EAAjD;EAEA,MAAMkB,WAAW,GAAGrB,WAAW,CAAEsB,MAAD,IAC5BZ,OAAO,CAACa,QAAQ,IAAIhB,cAAc,CAACgB,QAAD,EAAWD,MAAX,CAA3B,CADoB,EAE7B,EAF6B,CAA/B;EAIA,MAAME,iBAAiB,GAAGxB,WAAW,CAAC,YAAW;IAC7C,MAAMyB,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;IACA,MAAMC,OAAO,GAAG,EAAE,GAAGlB,IAAL;MAAWmB,QAAQ,EAAEX,QAAQ,CAACY;IAA9B,CAAhB;IAEAC,MAAM,CAACC,IAAP,CAAYJ,OAAZ,EAAqBK,OAArB,CAA8BC,OAAD,IAAaR,QAAQ,CAACS,MAAT,CAAgBD,OAAhB,EAAyBN,OAAO,CAACM,OAAD,CAAhC,CAA1C;IAEA,MAAME,IAAI,GAAG,MAAMhB,OAAO,CAAC;MAAEiB,GAAG,EAAE,oBAAP;MAA6BC,MAAM,EAAE,MAArC;MAA6CC,IAAI,EAAEb,QAAnD;MAA6Dc,cAAc,EAAE;IAA7E,CAAD,CAA1B;;IAEA,IAAIJ,IAAI,CAACK,MAAL,KAAgB,GAApB,EAAyB;MACrB9B,OAAO,CAAC,EAAD,CAAP;MACAE,iBAAiB,CAACuB,IAAI,CAACM,OAAN,CAAjB;MACAzB,kBAAkB;IACrB;EACJ,CAboC,EAalC,CAACP,IAAD,EAAOU,OAAP,EAAgBH,kBAAhB,EAAoCC,QAAQ,CAACY,MAA7C,CAbkC,CAArC;EAeA,MAAMa,eAAe,GAAG1C,WAAW,CAAC,MAChCgB,kBAAkB,EADa,EAEjC,CAACA,kBAAD,CAFiC,CAAnC;EAIA,oBACI,QAAC,QAAD;IACI,QAAQ,EAAC,UADb;IAEI,IAAI,EAAEP,IAFV;IAGI,WAAW,EAAEY,WAHjB;IAII,OAAO,EAAEH,OAJb;IAKI,WAAW,EAAEE,WALjB;IAMI,cAAc,EAAET,cANpB;IAOI,cAAc,EAAEG,cAPpB;IAQI,eAAe,EAAE4B,eARrB;IASI,iBAAiB,EAAElB,iBATvB;IAUI,gBAAgB,EAAC;EAVrB;IAAA;IAAA;IAAA;EAAA,QADJ;AAcH,CA/CM;;GAAMhB,U;UAIwDH,S,EAIvBF,O;;;KARjCK,U"},"metadata":{},"sourceType":"module"}