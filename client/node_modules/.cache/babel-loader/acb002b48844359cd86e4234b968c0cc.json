{"ast":null,"code":"var _jsxFileName = \"/Users/ksena/\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435/React/lessons/Shop_1001/client/src/pages/basket/Basket.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport { LoadingCircular } from '../../component/loading/LoadingCircular';\nimport { BasketContext } from '../../context/BasketContext';\nimport { useHttp } from '../../hooks/http.hook';\nimport { normalizeBooks } from '../../utils/normalizeBooks';\nimport { BasketList } from './components/BasketList';\nimport { formatQueryString } from '../../utils/formatQueryString';\nimport { GoBackPage } from '../../component/goBackPage/GoBackPage';\nimport './style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const Basket = () => {\n  _s();\n\n  const [books, setBooks] = useState([]);\n  const {\n    booksLocalStore\n  } = useContext(BasketContext);\n  const {\n    loading,\n    request\n  } = useHttp();\n  const idsForRequest = booksLocalStore.map(book => book.idBook);\n  const showBooks = useCallback(async () => {\n    const result = await request({\n      url: formatQueryString(`basket/books`, {\n        id: idsForRequest\n      })\n    });\n    const resultData = result.map(book => book[0]);\n    setBooks([...normalizeBooks(resultData)]);\n  }, [request]);\n  useEffect(() => {\n    idsForRequest.length && showBooks();\n  }, [showBooks]);\n  useEffect(() => {\n    setBooks(prevBooks => prevBooks.filter(book => booksLocalStore.find(localBook => book.idBook === localBook.idBook && localBook.quantity)));\n  }, [booksLocalStore]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(GoBackPage, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"wrapperBasket\",\n      children: [loading && /*#__PURE__*/_jsxDEV(LoadingCircular, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 29\n      }, this), books.length ? /*#__PURE__*/_jsxDEV(BasketList, {\n        books: books\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 23\n      }, this) : /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Sorry, there are no items in the basket ((\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 23\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Basket, \"+bcV5zPHXmifz2J5frJzl5zVydc=\", false, function () {\n  return [useHttp];\n});\n\n_c = Basket;\n\nvar _c;\n\n$RefreshReg$(_c, \"Basket\");","map":{"version":3,"names":["React","useCallback","useContext","useEffect","useState","LoadingCircular","BasketContext","useHttp","normalizeBooks","BasketList","formatQueryString","GoBackPage","Basket","books","setBooks","booksLocalStore","loading","request","idsForRequest","map","book","idBook","showBooks","result","url","id","resultData","length","prevBooks","filter","find","localBook","quantity"],"sources":["/Users/ksena/Программирование/React/lessons/Shop_1001/client/src/pages/basket/Basket.tsx"],"sourcesContent":["import React, { useCallback, useContext, useEffect, useState } from 'react'\n\nimport { LoadingCircular } from '../../component/loading/LoadingCircular'\nimport { BasketContext } from '../../context/BasketContext'\nimport { useHttp } from '../../hooks/http.hook'\nimport { IBook, IBookResponce } from '../../interface/IBook'\nimport { normalizeBooks } from '../../utils/normalizeBooks'\nimport { BasketList } from './components/BasketList'\nimport { formatQueryString } from '../../utils/formatQueryString'\nimport { GoBackPage } from '../../component/goBackPage/GoBackPage'\n\nimport './style.css'\n\nexport const Basket = () => {\n    const [books, setBooks] = useState<IBook[]>([])\n    \n    const { booksLocalStore } = useContext(BasketContext)\n    \n    const { loading, request } = useHttp()\n    \n    const idsForRequest = booksLocalStore.map(book => book.idBook)\n    \n    const showBooks = useCallback(async() => {\n        const result = await request({ url: formatQueryString(`basket/books`, { id: idsForRequest }) })\n        const resultData = result.map((book: IBookResponce[]) => book[0])\n        setBooks([...normalizeBooks(resultData)])\n    }, [request])\n\n    useEffect(() => {\n        idsForRequest.length && showBooks()\n    }, [showBooks])\n\n    useEffect(() => {\n        setBooks(prevBooks => prevBooks.filter(book => \n            booksLocalStore.find(localBook => book.idBook === localBook.idBook && localBook.quantity )))\n    }, [booksLocalStore])\n\n    return (\n        <>\n            <GoBackPage />\n            <div className=\"wrapperBasket\">\n                {loading && <LoadingCircular />}\n                {books.length \n                    ? <BasketList books={books} />\n                    : <h2>Sorry, there are no items in the basket ((</h2>\n                }\n            </div>\n        </>\n    )\n}\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,WAAhB,EAA6BC,UAA7B,EAAyCC,SAAzC,EAAoDC,QAApD,QAAoE,OAApE;AAEA,SAASC,eAAT,QAAgC,yCAAhC;AACA,SAASC,aAAT,QAA8B,6BAA9B;AACA,SAASC,OAAT,QAAwB,uBAAxB;AAEA,SAASC,cAAT,QAA+B,4BAA/B;AACA,SAASC,UAAT,QAA2B,yBAA3B;AACA,SAASC,iBAAT,QAAkC,+BAAlC;AACA,SAASC,UAAT,QAA2B,uCAA3B;AAEA,OAAO,aAAP;;;AAEA,OAAO,MAAMC,MAAM,GAAG,MAAM;EAAA;;EACxB,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBV,QAAQ,CAAU,EAAV,CAAlC;EAEA,MAAM;IAAEW;EAAF,IAAsBb,UAAU,CAACI,aAAD,CAAtC;EAEA,MAAM;IAAEU,OAAF;IAAWC;EAAX,IAAuBV,OAAO,EAApC;EAEA,MAAMW,aAAa,GAAGH,eAAe,CAACI,GAAhB,CAAoBC,IAAI,IAAIA,IAAI,CAACC,MAAjC,CAAtB;EAEA,MAAMC,SAAS,GAAGrB,WAAW,CAAC,YAAW;IACrC,MAAMsB,MAAM,GAAG,MAAMN,OAAO,CAAC;MAAEO,GAAG,EAAEd,iBAAiB,CAAE,cAAF,EAAiB;QAAEe,EAAE,EAAEP;MAAN,CAAjB;IAAxB,CAAD,CAA5B;IACA,MAAMQ,UAAU,GAAGH,MAAM,CAACJ,GAAP,CAAYC,IAAD,IAA2BA,IAAI,CAAC,CAAD,CAA1C,CAAnB;IACAN,QAAQ,CAAC,CAAC,GAAGN,cAAc,CAACkB,UAAD,CAAlB,CAAD,CAAR;EACH,CAJ4B,EAI1B,CAACT,OAAD,CAJ0B,CAA7B;EAMAd,SAAS,CAAC,MAAM;IACZe,aAAa,CAACS,MAAd,IAAwBL,SAAS,EAAjC;EACH,CAFQ,EAEN,CAACA,SAAD,CAFM,CAAT;EAIAnB,SAAS,CAAC,MAAM;IACZW,QAAQ,CAACc,SAAS,IAAIA,SAAS,CAACC,MAAV,CAAiBT,IAAI,IACvCL,eAAe,CAACe,IAAhB,CAAqBC,SAAS,IAAIX,IAAI,CAACC,MAAL,KAAgBU,SAAS,CAACV,MAA1B,IAAoCU,SAAS,CAACC,QAAhF,CADkB,CAAd,CAAR;EAEH,CAHQ,EAGN,CAACjB,eAAD,CAHM,CAAT;EAKA,oBACI;IAAA,wBACI,QAAC,UAAD;MAAA;MAAA;MAAA;IAAA,QADJ,eAEI;MAAK,SAAS,EAAC,eAAf;MAAA,WACKC,OAAO,iBAAI,QAAC,eAAD;QAAA;QAAA;QAAA;MAAA,QADhB,EAEKH,KAAK,CAACc,MAAN,gBACK,QAAC,UAAD;QAAY,KAAK,EAAEd;MAAnB;QAAA;QAAA;QAAA;MAAA,QADL,gBAEK;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAJV;IAAA;MAAA;MAAA;MAAA;IAAA,QAFJ;EAAA,gBADJ;AAYH,CApCM;;GAAMD,M;UAKoBL,O;;;KALpBK,M"},"metadata":{},"sourceType":"module"}