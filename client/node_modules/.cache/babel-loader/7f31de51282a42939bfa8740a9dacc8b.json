{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback, useEffect, useState } from 'react';\nconst storageName = 'bookData';\nexport const useBasket = () => {\n  _s();\n\n  let bookData = JSON.parse(localStorage.getItem(storageName)) || [];\n  const [booksLocalStore, setBooksLocalStore] = useState(bookData);\n  useEffect(() => localStorage.setItem(storageName, JSON.stringify(booksLocalStore)), [booksLocalStore]);\n  const addBookToBasket = useCallback(id => {\n    setBooksLocalStore(prevState => {\n      const findBook = prevState.find(book => book.idBook === id);\n      if (!findBook) return [...prevState, {\n        idBook: id,\n        quantity: 1\n      }];\n      return prevState.map(book => book.idBook === id ? { ...book,\n        quantity: book.quantity + 1\n      } : book);\n    });\n  }, [setBooksLocalStore]);\n  const decreaseBookFromBasket = useCallback(id => {\n    setBooksLocalStore(prevState => {\n      return prevState.map(book => {\n        if (book.idBook === id) {\n          if (book.quantity === 1) return book;\n          return { ...book,\n            quantity: book.quantity - 1\n          };\n        }\n\n        return book;\n      });\n    });\n  }, [setBooksLocalStore]);\n  const removeBookFromBasket = useCallback(id => setBooksLocalStore(prevState => prevState.filter(book => book.idBook !== id)), [setBooksLocalStore]);\n  return {\n    booksLocalStore,\n    addBookToBasket,\n    decreaseBookFromBasket,\n    removeBookFromBasket\n  };\n};\n\n_s(useBasket, \"EDyYC77DvkvGXmQdIAI3E6vQ2fU=\");","map":{"version":3,"names":["useCallback","useEffect","useState","storageName","useBasket","bookData","JSON","parse","localStorage","getItem","booksLocalStore","setBooksLocalStore","setItem","stringify","addBookToBasket","id","prevState","findBook","find","book","idBook","quantity","map","decreaseBookFromBasket","removeBookFromBasket","filter"],"sources":["/Users/ksena/Программирование/React/lessons/Shop_1001/client/src/hooks/basket.hook.ts"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react'\n\nconst storageName = 'bookData'\n\nexport type LocalStorageBookType = {\n   idBook: string,\n   quantity: number,\n}\n\nexport const useBasket = () => {\n   let bookData = JSON.parse(localStorage.getItem(storageName) as string) || []\n\n   const [booksLocalStore, setBooksLocalStore] = useState<LocalStorageBookType[]>(bookData)\n\n   useEffect(() => \n      localStorage.setItem(storageName, JSON.stringify(booksLocalStore))\n   , [booksLocalStore])\n\n   const addBookToBasket = useCallback((id: string) => {\n      setBooksLocalStore(prevState => {\n         const findBook = prevState.find(book => book.idBook === id)\n\n         if (!findBook) \n            return [...prevState, { idBook: id, quantity: 1 }]\n         \n         return prevState.map(book => (book.idBook === id) ? { ...book, quantity: book.quantity + 1 } : book)\n      })\n   }, [setBooksLocalStore])\n\n   const decreaseBookFromBasket = useCallback((id: string) => {\n      setBooksLocalStore(prevState => {\n         return prevState.map(book => {\n            if (book.idBook === id) {\n               if (book.quantity === 1) return book\n               \n               return { ...book, quantity: book.quantity - 1 }\n            }\n            return book\n         })\n      })\n   }, [setBooksLocalStore])\n\n   const removeBookFromBasket = useCallback((id: string) => \n      setBooksLocalStore(prevState => prevState.filter(book => book.idBook !== id))\n   , [setBooksLocalStore])\n\n   return { booksLocalStore, addBookToBasket, decreaseBookFromBasket, removeBookFromBasket }\n}\n"],"mappings":";;AAAA,SAAgBA,WAAhB,EAA6BC,SAA7B,EAAwCC,QAAxC,QAAwD,OAAxD;AAEA,MAAMC,WAAW,GAAG,UAApB;AAOA,OAAO,MAAMC,SAAS,GAAG,MAAM;EAAA;;EAC5B,IAAIC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBN,WAArB,CAAX,KAA2D,EAA1E;EAEA,MAAM,CAACO,eAAD,EAAkBC,kBAAlB,IAAwCT,QAAQ,CAAyBG,QAAzB,CAAtD;EAEAJ,SAAS,CAAC,MACPO,YAAY,CAACI,OAAb,CAAqBT,WAArB,EAAkCG,IAAI,CAACO,SAAL,CAAeH,eAAf,CAAlC,CADM,EAEP,CAACA,eAAD,CAFO,CAAT;EAIA,MAAMI,eAAe,GAAGd,WAAW,CAAEe,EAAD,IAAgB;IACjDJ,kBAAkB,CAACK,SAAS,IAAI;MAC7B,MAAMC,QAAQ,GAAGD,SAAS,CAACE,IAAV,CAAeC,IAAI,IAAIA,IAAI,CAACC,MAAL,KAAgBL,EAAvC,CAAjB;MAEA,IAAI,CAACE,QAAL,EACG,OAAO,CAAC,GAAGD,SAAJ,EAAe;QAAEI,MAAM,EAAEL,EAAV;QAAcM,QAAQ,EAAE;MAAxB,CAAf,CAAP;MAEH,OAAOL,SAAS,CAACM,GAAV,CAAcH,IAAI,IAAKA,IAAI,CAACC,MAAL,KAAgBL,EAAjB,GAAuB,EAAE,GAAGI,IAAL;QAAWE,QAAQ,EAAEF,IAAI,CAACE,QAAL,GAAgB;MAArC,CAAvB,GAAkEF,IAAxF,CAAP;IACF,CAPiB,CAAlB;EAQF,CATkC,EAShC,CAACR,kBAAD,CATgC,CAAnC;EAWA,MAAMY,sBAAsB,GAAGvB,WAAW,CAAEe,EAAD,IAAgB;IACxDJ,kBAAkB,CAACK,SAAS,IAAI;MAC7B,OAAOA,SAAS,CAACM,GAAV,CAAcH,IAAI,IAAI;QAC1B,IAAIA,IAAI,CAACC,MAAL,KAAgBL,EAApB,EAAwB;UACrB,IAAII,IAAI,CAACE,QAAL,KAAkB,CAAtB,EAAyB,OAAOF,IAAP;UAEzB,OAAO,EAAE,GAAGA,IAAL;YAAWE,QAAQ,EAAEF,IAAI,CAACE,QAAL,GAAgB;UAArC,CAAP;QACF;;QACD,OAAOF,IAAP;MACF,CAPM,CAAP;IAQF,CATiB,CAAlB;EAUF,CAXyC,EAWvC,CAACR,kBAAD,CAXuC,CAA1C;EAaA,MAAMa,oBAAoB,GAAGxB,WAAW,CAAEe,EAAD,IACtCJ,kBAAkB,CAACK,SAAS,IAAIA,SAAS,CAACS,MAAV,CAAiBN,IAAI,IAAIA,IAAI,CAACC,MAAL,KAAgBL,EAAzC,CAAd,CADmB,EAEtC,CAACJ,kBAAD,CAFsC,CAAxC;EAIA,OAAO;IAAED,eAAF;IAAmBI,eAAnB;IAAoCS,sBAApC;IAA4DC;EAA5D,CAAP;AACF,CAtCM;;GAAMpB,S"},"metadata":{},"sourceType":"module"}