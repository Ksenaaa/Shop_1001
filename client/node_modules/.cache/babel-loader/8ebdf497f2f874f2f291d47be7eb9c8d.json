{"ast":null,"code":"var _jsxFileName = \"/Users/ksena/\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435/React/lessons/Shop_1001/client/src/pages/editeBook/EditeBook.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router';\nimport { BookForm } from '../../component/bookForm/BookForm';\nimport { AuthContext } from '../../context/AuthContext';\nimport { useHttp } from '../../hooks/http.hook';\nimport { useToggle } from '../../hooks/toggle.hook';\nimport { RouteNames } from '../../interface/IRoute';\nimport { addFieldToBook } from '../../utils/addFieldToBook';\nimport { normalizeBook } from '../../utils/normalizeBooks';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const EditeBook = () => {\n  _s();\n\n  const [form, setForm] = useState({});\n  const [messageCreated, setMessageCreated] = useState('');\n  const navigate = useNavigate();\n  const {\n    isOpen: isShowSnackbar,\n    onToggle: toggleShowSnackbar\n  } = useToggle();\n  const {\n    userAuth\n  } = useContext(AuthContext);\n  const {\n    loading,\n    request,\n    errorsValid\n  } = useHttp();\n  const {\n    idBook\n  } = useParams();\n  const showBook = useCallback(async () => {\n    const result = await request({\n      url: `books/${idBook}`\n    });\n\n    if (userAuth.userId === result.sellerId) {\n      setForm(preForm => {\n        let newform = Object.fromEntries(Object.entries(normalizeBook(result)).filter(item => item[0] !== 'idBook'));\n        return { ...preForm,\n          ...newform\n        };\n      });\n    } else {\n      setMessageCreated(\"It doesn't your book!\");\n      toggleShowSnackbar();\n      setTimeout(() => navigate(RouteNames.MAIN), 2000);\n    }\n  }, [idBook, request, toggleShowSnackbar, navigate, userAuth.userId]);\n  useEffect(() => {\n    showBook();\n  }, [showBook]);\n  const setFormBook = useCallback(target => setForm(prevForm => addFieldToBook(prevForm, target)), []);\n  const handlerCreateBook = useCallback(async () => {\n    const formData = new FormData();\n    const newForm = { ...form\n    };\n    Object.keys(newForm).forEach(formKey => formData.append(formKey, newForm[formKey]));\n    const data = await request({\n      url: `edite/edite-book/${idBook}`,\n      method: 'PUT',\n      body: formData,\n      notJsonContent: true\n    });\n\n    if (data.status === 200) {\n      setMessageCreated(data.message);\n      toggleShowSnackbar();\n      setTimeout(() => navigate(-2), 2000);\n    }\n  }, [form, toggleShowSnackbar, request, idBook, navigate]);\n  const onCloseSnackbar = useCallback(() => toggleShowSnackbar(), [toggleShowSnackbar]);\n  return /*#__PURE__*/_jsxDEV(BookForm, {\n    namePage: \"Edite Book\",\n    form: form,\n    setFormBook: setFormBook,\n    loading: loading,\n    errorsValid: errorsValid,\n    messageCreated: messageCreated,\n    isShowSnackbar: isShowSnackbar,\n    onCloseSnackbar: onCloseSnackbar,\n    handlerCreateBook: handlerCreateBook,\n    buttonCreateName: \"Edite\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 9\n  }, this);\n};\n\n_s(EditeBook, \"eO/96tiu6WXTZKGBSwRZkFA8dvU=\", false, function () {\n  return [useNavigate, useToggle, useHttp, useParams];\n});\n\n_c = EditeBook;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditeBook\");","map":{"version":3,"names":["React","useCallback","useContext","useEffect","useState","useNavigate","useParams","BookForm","AuthContext","useHttp","useToggle","RouteNames","addFieldToBook","normalizeBook","EditeBook","form","setForm","messageCreated","setMessageCreated","navigate","isOpen","isShowSnackbar","onToggle","toggleShowSnackbar","userAuth","loading","request","errorsValid","idBook","showBook","result","url","userId","sellerId","preForm","newform","Object","fromEntries","entries","filter","item","setTimeout","MAIN","setFormBook","target","prevForm","handlerCreateBook","formData","FormData","newForm","keys","forEach","formKey","append","data","method","body","notJsonContent","status","message","onCloseSnackbar"],"sources":["/Users/ksena/Программирование/React/lessons/Shop_1001/client/src/pages/editeBook/EditeBook.tsx"],"sourcesContent":["import React, { ChangeEvent, useCallback, useContext, useEffect, useState } from 'react'\nimport { useNavigate, useParams } from 'react-router'\n\nimport { BookForm } from '../../component/bookForm/BookForm'\nimport { AuthContext } from '../../context/AuthContext'\nimport { useHttp } from '../../hooks/http.hook'\nimport { useToggle } from '../../hooks/toggle.hook'\nimport { IBook } from '../../interface/IBook'\nimport { RouteNames } from '../../interface/IRoute'\nimport { addFieldToBook } from '../../utils/addFieldToBook'\nimport { normalizeBook } from '../../utils/normalizeBooks'\n\nexport const EditeBook = () => {\n    const [form, setForm] = useState<Record<string, keyof Omit<IBook, 'idBook'>>>({})\n    const [messageCreated, setMessageCreated] = useState<string>('')\n    \n    const navigate = useNavigate()\n    \n    const { isOpen: isShowSnackbar, onToggle: toggleShowSnackbar } = useToggle()\n    \n    const { userAuth } = useContext(AuthContext)\n    \n    const { loading, request, errorsValid } = useHttp()\n    \n    const { idBook } = useParams()\n    \n    const showBook = useCallback(async () => {\n        const result = await request({ url: `books/${idBook}` })\n        \n        if (userAuth.userId === result.sellerId) {\n            setForm(preForm => {\n                let newform = Object.fromEntries(Object.entries(normalizeBook(result)).filter(item => item[0] !== 'idBook'))\n                return { ...preForm, ...newform } as Record<string, keyof Omit<IBook, 'idBook'>>\n            })    \n        } else {\n            setMessageCreated(\"It doesn't your book!\") \n            toggleShowSnackbar()\n            setTimeout(() => navigate(RouteNames.MAIN), 2000)\n        }    \n    }, [idBook, request, toggleShowSnackbar, navigate, userAuth.userId])    \n    \n    useEffect(() => {\n        showBook()\n    }, [showBook])    \n    \n    const setFormBook = useCallback((target: ChangeEvent<HTMLInputElement>) => \n        setForm(prevForm => addFieldToBook(prevForm, target))\n    , [])    \n    \n    const handlerCreateBook = useCallback(async() => {\n        const formData = new FormData()\n        const newForm = { ...form } \n        \n        Object.keys(newForm).forEach((formKey) => formData.append(formKey, newForm[formKey]))\n        \n        const data = await request({ url: `edite/edite-book/${idBook}`, method: 'PUT', body: formData, notJsonContent: true })\n        \n        if (data.status === 200) {\n            setMessageCreated(data.message)\n            toggleShowSnackbar()\n            setTimeout(() => navigate(-2), 2000)\n        }    \n    }, [form, toggleShowSnackbar, request, idBook, navigate])    \n    \n    const onCloseSnackbar = useCallback(() => \n        toggleShowSnackbar()\n    , [toggleShowSnackbar])\n    \n    return (\n        <BookForm\n            namePage='Edite Book'\n            form={form}\n            setFormBook={setFormBook}\n            loading={loading}\n            errorsValid={errorsValid}\n            messageCreated={messageCreated}\n            isShowSnackbar={isShowSnackbar}\n            onCloseSnackbar={onCloseSnackbar}\n            handlerCreateBook={handlerCreateBook}\n            buttonCreateName='Edite'\n        />\n    )\n} \n"],"mappings":"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"},"metadata":{},"sourceType":"module"}